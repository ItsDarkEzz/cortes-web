# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: REST API –¥–ª—è Cortes Dashboard

## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ë–∞–∑–æ–≤—ã–π URL:** `https://api.thecortes.ru/v1`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** API –¥–ª—è –≤–µ–±-–ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –±–æ—Ç–∞ Cortes –≤ Telegram —á–∞—Ç–∞—Ö.

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∞–π—Ç–∞:**
- –°–∞–π—Ç –ù–ï –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å –Ω–∞–∫–∞–∑–∞–Ω–∏—è (ban, mute, kick, warn) ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –°–∞–π—Ç –ù–ï —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞—è–≤–∫–∞–º–∏ Face-control ‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ Telegram
- –°–∞–π—Ç –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞–∑–Ω–∞—á–∞—Ç—å —Ä–æ–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
- –°–∞–π—Ç –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∫–∞–∫ –ø–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞

---

## 1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ú–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram Bot

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ deep-link –±–æ—Ç–∞, –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Telegram Login Widget.

#### –ü—Ä–æ—Ü–µ—Å—Å:
1. –°–∞–π—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `auth_token` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –±–∞–∑–µ
2. –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞: `https://t.me/CortesBot?start=auth_{auth_token}`
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ, –Ω–∞–∂–∏–º–∞–µ—Ç /start
4. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç `auth_token`, —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å `user_id` Telegram
5. –°–∞–π—Ç —á–µ—Ä–µ–∑ polling –∏–ª–∏ WebSocket —É–∑–Ω–∞—ë—Ç –æ–± —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
6. –°–µ—Ä–≤–µ—Ä –≤—ã–¥–∞—ë—Ç JWT —Ç–æ–∫–µ–Ω—ã

### POST /auth/init
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è –≤—Ö–æ–¥–∞.

**Response:**
```json
{
  "auth_token": "abc123xyz",
  "bot_link": "https://t.me/TheCortesBot?start=auth_abc123xyz",
  "expires_in": 300
}
```

### GET /auth/status/{auth_token}
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (polling).

**Response (–æ–∂–∏–¥–∞–Ω–∏–µ):**
```json
{
  "status": "pending"
}
```

**Response (—É—Å–ø–µ—Ö):**
```json
{
  "status": "success",
  "access_token": "jwt_access_token",
  "refresh_token": "jwt_refresh_token",
  "user": {
    "id": 123456789,
    "name": "–®–∞—Ö—Ä–∏—ë—Ä",
    "username": "itsdarkez",
    "avatar": "https://t.me/i/userpic/...",
    "level": 1, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
    "xp": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
    "xp_to_next": 0 // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
  }
}
```

**Response (–∏—Å—Ç—ë–∫):**
```json
{
  "status": "expired"
}
```

### POST /auth/refresh
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞.

**Request:**
```json
{
  "refresh_token": "jwt_refresh_token"
}
```

**Response:**
```json
{
  "access_token": "new_jwt_access_token"
}
```

### POST /auth/logout
–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.

---

## 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

### GET /user/me
–¢–µ–∫—É—â–∏–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

**Response:**
```json
{
  "id": 123456789,
  "name": "–®–∞—Ö—Ä–∏—ë—Ä",
  "username": "itsdarkez",
  "avatar": "https://t.me/i/userpic/...",
  "level": 1, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
  "xp": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
  "xp_to_next": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
  "created_at": "2024-03-15T10:00:00Z"
}
```

### GET /user/stats
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞.

**Response:**
```json
{
  "messages_total": 12500,
  "quests_completed": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
  "achievements_unlocked": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
  "achievements_total": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
  "days_active": 89,
  "chats_count": 3
}
```

### PATCH /user/profile/name
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (—Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è).

**Request:**
```json
{
  "display_name": "–®–∞—Ö—Ä–∏—ë—Ä Dev"
}
```

---

## 3. –ß–∞—Ç—ã

### GET /chats
–°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–º/–∞–¥–º–∏–Ω–æ–º.

**Response:**
```json
{
  "chats": [
    {
      "id": -1001234567890,
      "name": "Dev Community",
      "description": "–°–æ–æ–±—â–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤",
      "members_count": 1250,
      "messages_today": 156,
      "bot_responses_today": 45,
      "bot_active": true,
      "plan": "BETA", // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
      "plan_expires_at": "2030-01-15T00:00:00Z" // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
    }
  ]
}
```

### GET /chats/{chat_id}
–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ.

**Response:**
```json
{
  "id": -1001234567890,
  "name": "Dev Community",
  "description": "–°–æ–æ–±—â–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π",
  "rules": "1. –£–≤–∞–∂–∞–π—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞\n2. –ë–µ–∑ —Å–ø–∞–º–∞\n3. –¢–æ–ª—å–∫–æ –ø–æ —Ç–µ–º–µ",
  "members_count": 1250,
  "created_at": "2024-03-15T10:00:00Z",
  "stats": {
    "messages_total": 125000,
    "messages_today": 156,
    "bot_responses_total": 8900,
    "bot_responses_today": 45,
    "days_active": 89
  }
}
```

### PATCH /chats/{chat_id}
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Ç–µ.

**Request:**
```json
{
  "name": "Dev Community",
  "description": "–ù–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
  "rules": "–ù–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —á–∞—Ç–∞"
}
```

---

## 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞

### GET /chats/{chat_id}/settings
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ –¥–ª—è —á–∞—Ç–∞.

**Response:**
```json
{
  "bot": {
    "name": "Cortes",
    "personality": "friendly",
    "auto_reply_enabled": true,
    "welcome_enabled": true,
    "welcome_message": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Dev Community! üéâ",
    "inactivity_enabled": true,
    "inactivity_hours": 6,
    "inactivity_messages": [
      "–ß—Ç–æ-—Ç–æ —Ç–∏—Ö–æ —Å—Ç–∞–ª–æ...",
      "–≠–π, –µ—Å—Ç—å –∫—Ç–æ –∂–∏–≤–æ–π?"
    ]
  },
  "moderation": {
    "ban_enabled": true,
    "ban_message": "üö´ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ {duration}.\n–ü—Ä–∏—á–∏–Ω–∞: {reason}",
    "mute_enabled": true,
    "mute_message": "üîá –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user} –∑–∞–≥–ª—É—à–µ–Ω –Ω–∞ {duration}.\n–ü—Ä–∏—á–∏–Ω–∞: {reason}",
    "kick_enabled": true,
    "kick_message": "üë¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user} —É–¥–∞–ª—ë–Ω –∏–∑ —á–∞—Ç–∞.\n–ü—Ä–∏—á–∏–Ω–∞: {reason}",
    "warn_enabled": true,
    "warn_message": "‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user} –ø–æ–ª—É—á–∏–ª –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ({warnings}/{max}).\n–ü—Ä–∏—á–∏–Ω–∞: {reason}",
    "warnings_for_ban": 3,
    "ban_duration_days": 30,
    "warning_expire_days": 14,
    "auto_ban_message": "üö´ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ {days} –¥–Ω–µ–π.\n–ü—Ä–∏—á–∏–Ω–∞: –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π ({warnings}/{max}).\n–ü–æ—Å–ª–µ–¥–Ω–µ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ: {reason}",
    "report_enabled": true,
    "report_message": "üö® –ñ–∞–ª–æ–±–∞ –æ—Ç {user} –Ω–∞ {target}.\n–°–æ–æ–±—â–µ–Ω–∏–µ: {message}",
    "read_only_enabled": true,
    "read_only_message": "üîí –ß–∞—Ç –ø–µ—Ä–µ–≤–µ–¥—ë–Ω –≤ —Ä–µ–∂–∏–º —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è."
  },
  "filters": {
    "stop_words_enabled": true,
    "stop_words": ["—Å–ø–∞–º", "—Ä–µ–∫–ª–∞–º–∞", "–∫–∞–∑–∏–Ω–æ"],
    "stop_word_message": "‚ö†Ô∏è –°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ. –ü—Ä–∏—á–∏–Ω–∞: –∑–∞–ø—Ä–µ—â—ë–Ω–Ω–æ–µ —Å–ª–æ–≤–æ.",
    "block_channel_posts": true,
    "blocked_channels": ["@spam_channel", "@ads_channel"],
    "channel_block_message": "‚ö†Ô∏è –†–µ–ø–æ—Å—Ç –∏–∑ —ç—Ç–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –Ω–µ –ø—Ä–∏–µ–º–ª–µ–º –≤ —á–∞—Ç–µ.",
    "filter_arabic": false,
    "filter_chinese": false,
    "filter_zalgo": true,
    "nsfw_filter_enabled": true,
    "nsfw_message": "üîû –°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ. –ü—Ä–∏—á–∏–Ω–∞: NSFW –∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞–ø—Ä–µ—â—ë–Ω."
  },
  "media_permissions": {
    "can_send_photos": true,
    "can_send_videos": true,
    "can_send_video_notes": false,
    "can_send_voice_notes": false,
    "can_send_documents": true,
    "can_send_audios": true,
    "can_send_stickers": true,
    "can_send_polls": true,
    "can_send_links": true
  },
  "face_control": {
    "enabled": true,
    "require_avatar": true,
    "require_username": true,
    "min_name_length": 2,
    "nsfw_avatar_check": true,
    "questionnaire_enabled": true,
    "questionnaire_intro": "üëã –ü—Ä–∏–≤–µ—Ç! –î–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —á–∞—Ç –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤.",
    "questionnaire_success": "‚úÖ –°–ø–∞—Å–∏–±–æ! –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º.",
    "questionnaire_questions": [
      {
        "id": 1,
        "text": "–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∏ –æ —á–∞—Ç–µ?",
        "required": true,
        "order": 1
      },
      {
        "id": 2,
        "text": "–ß–µ–º –∑–∞–Ω–∏–º–∞–µ—Ç–µ—Å—å?",
        "required": true,
        "order": 2
      },
      {
        "id": 3,
        "text": "–ü–æ—á–µ–º—É —Ö–æ—Ç–∏—Ç–µ –≤—Å—Ç—É–ø–∏—Ç—å?",
        "required": false,
        "order": 3
      }
    ]
  }
}
```

### PATCH /chats/{chat_id}/settings
–ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫.

**Request (–ø—Ä–∏–º–µ—Ä ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞):**
```json
{
  "bot": {
    "name": "Cortes AI",
    "personality": "professional",
    "welcome_message": "–ù–æ–≤–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ!"
  }
}
```

**Request (–ø—Ä–∏–º–µ—Ä ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏):**
```json
{
  "moderation": {
    "warnings_for_ban": 5,
    "ban_message": "–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–∞–Ω–∞"
  }
}
```

**Request (–ø—Ä–∏–º–µ—Ä ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤):**
```json
{
  "filters": {
    "stop_words": ["—Å–ø–∞–º", "—Ä–µ–∫–ª–∞–º–∞", "–Ω–æ–≤–æ–µ_—Å–ª–æ–≤–æ"],
    "filter_arabic": true
  }
}
```

**Request (–ø—Ä–∏–º–µ—Ä ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞):**
```json
{
  "media_permissions": {
    "can_send_voice_notes": true,
    "can_send_video_notes": true
  }
}
```

**Request (–ø—Ä–∏–º–µ—Ä ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ face-control):**
```json
{
  "face_control": {
    "require_avatar": false,
    "questionnaire_questions": [
      { "id": 1, "text": "–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å 1", "required": true, "order": 1 },
      { "id": 2, "text": "–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å 2", "required": false, "order": 2 }
    ]
  }
}
```

---

## 5. –£—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞

### GET /chats/{chat_id}/members
–°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (default: 1)
- `limit` ‚Äî –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É (default: 20, max: 100)
- `search` ‚Äî –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/username
- `role` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏ (owner, admin, moderator, member)

**Response:**
```json
{
  "members": [
    {
      "id": 123456789,
      "name": "–®–∞—Ö—Ä–∏—ë—Ä",
      "username": "@shahriyor_dev",
      "avatar": "https://t.me/i/userpic/...",
      "role": "owner",
      "level": 1, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
      "sympathy": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
      "warnings": 0,
      "joined_at": "2024-03-15T10:00:00Z"
    },
    {
      "id": 234567890,
      "name": "–ê–ª–µ–∫—Å–µ–π",
      "username": "@alexey",
      "avatar": "https://t.me/i/userpic/...",
      "role": "admin",
      "level": 1, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
      "sympathy": 0, // –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
      "warnings": 0,
      "joined_at": "2024-03-16T12:00:00Z"
    }
  ],
  "pagination": {
    "total": 1250,
    "page": 1,
    "limit": 20,
    "pages": 63
  }
}
```

### PATCH /chats/{chat_id}/members/{user_id}/role
–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞.

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–æ–ª–∏:** `admin`, `moderator`, `member`

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å owner
- –¢–æ–ª—å–∫–æ owner –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å admin
- Admin –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å —Ç–æ–ª—å–∫–æ moderator

**Request:**
```json
{
  "role": "moderator"
}
```

**Response:**
```json
{
  "success": true,
  "user_id": 234567890,
  "new_role": "moderator"
}
```

---

## 6. –õ–æ–≥–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è

### GET /chats/{chat_id}/logs
–õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤ (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä).

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` ‚Äî –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- `type` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É (ban, mute, warn, kick, delete, role, filter)
- `from` ‚Äî –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ (ISO 8601)
- `to` ‚Äî –¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞ (ISO 8601)

**Response:**
```json
{
  "logs": [
    {
      "id": 1,
      "type": "warn",
      "action": "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ",
      "target_id": 345678901,
      "target_name": "@dmitry",
      "by_id": 234567890,
      "by_name": "@maria",
      "reason": "–û—Ñ—Ñ—Ç–æ–ø",
      "created_at": "2024-12-20T14:32:00Z"
    },
    {
      "id": 2,
      "type": "delete",
      "action": "–£–¥–∞–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ",
      "target_id": 456789012,
      "target_name": "@anna",
      "by_id": null,
      "by_name": "–ê–≤—Ç–æ",
      "reason": "–°—Ç–æ–ø-—Å–ª–æ–≤–æ: —Ä–µ–∫–ª–∞–º–∞",
      "created_at": "2024-12-20T14:28:00Z"
    }
  ],
  "pagination": {
    "total": 156,
    "page": 1,
    "limit": 50,
    "pages": 4
  }
}
```

### GET /chats/{chat_id}/messages
–ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä).

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` ‚Äî –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- `deleted` ‚Äî —Ç–æ–ª—å–∫–æ —É–¥–∞–ª—ë–Ω–Ω—ã–µ (true/false)
- `user_id` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

**Response:**
```json
{
  "messages": [
    {
      "id": 12345,
      "user_id": 234567890,
      "user_name": "@alexey",
      "text": "–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º! –ö–∞–∫ –¥–µ–ª–∞ —Å –ø—Ä–æ–µ–∫—Ç–æ–º?",
      "created_at": "2024-12-20T14:35:00Z",
      "deleted": false,
      "deleted_at": null,
      "deleted_reason": null
    },
    {
      "id": 12346,
      "user_id": 456789012,
      "user_name": "@anna",
      "text": "[—É–¥–∞–ª–µ–Ω–æ]",
      "created_at": "2024-12-20T14:28:00Z",
      "deleted": true,
      "deleted_at": "2024-12-20T14:28:01Z",
      "deleted_reason": "–°—Ç–æ–ø-—Å–ª–æ–≤–æ: —Ä–µ–∫–ª–∞–º–∞"
    }
  ],
  "pagination": {
    "total": 12500,
    "page": 1,
    "limit": 50,
    "pages": 250
  }
}
```

---

## 7. Brain (–ü–∞–º—è—Ç—å –±–æ—Ç–∞)

### GET /chats/{chat_id}/brain
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –∫–∞–∫ –±–æ—Ç "–≤–∏–¥–∏—Ç" —á–∞—Ç.

**Response:**
```json
{
  "chat_tone": "–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π",
  "main_topics": ["–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", "AI/ML", "–°—Ç–∞—Ä—Ç–∞–ø—ã", "–ö–∞—Ä—å–µ—Ä–∞"],
  "active_hours": "10:00 - 22:00",
  "avg_response_time": "2-5 —Å–µ–∫",
  "memory_items": 156,
  "learned_patterns": [
    "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –ø–æ —É—Ç—Ä–∞–º",
    "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∏—Å–∫—É—Å—Å–∏–∏",
    "–Æ–º–æ—Ä –≤ –ø—è—Ç–Ω–∏—Ü—É"
  ],
  "user_relations": "–ó–Ω–∞–µ—Ç 45 –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏ —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è",
  "recent_learning": [
    "–ù–æ–≤—ã–π –º–µ–º –ø—Ä–æ JavaScript",
    "–¢—Ä–µ–Ω–¥ –Ω–∞ Rust",
    "–û–±—Å—É–∂–¥–µ–Ω–∏–µ GPT-5"
  ]
}
```

### PATCH /chats/{chat_id}/brain/instructions
–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

**Request:**
```json
{
  "instructions": "–ë—É–¥—å –±–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º, –∏–∑–±–µ–≥–∞–π —à—É—Ç–æ–∫, —Ñ–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ–º–∞—Ö."
}
```

**Response:**
```json
{
  "success": true,
  "instructions": "–ë—É–¥—å –±–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º, –∏–∑–±–µ–≥–∞–π —à—É—Ç–æ–∫, —Ñ–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ–º–∞—Ö."
}
```

---

## 8. –¢–∞—Ä–∏—Ñ—ã

### GET /plans
–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤.

**Response:**
```json
{
  "plans": [
    {
      "id": "free",
      "name": "Free",
      "price": 0,
      "currency": "RUB",
      "period": null,
      "features": [
        "100 —Å–æ–æ–±—â–µ–Ω–∏–π/–¥–µ–Ω—å",
        "–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è",
        "RPG —Å–∏—Å—Ç–µ–º–∞"
      ]
    },
    {
      "id": "pro",
      "name": "Pro",
      "price": 990,
      "currency": "RUB",
      "period": "month",
      "features": [
        "–ë–µ–∑–ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π",
        "–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏",
        "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞",
        "API –¥–æ—Å—Ç—É–ø"
      ],
      "popular": true
    },
    {
      "id": "business",
      "name": "Business",
      "price": 2990,
      "currency": "RUB",
      "period": "month",
      "features": [
        "–í—Å—ë –∏–∑ Pro",
        "–ù–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Ç–æ–≤",
        "–í—ã–¥–µ–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä",
        "SLA 99.9%"
      ]
    }
  ]
}
```

### GET /chats/{chat_id}/plan
–¢–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ —á–∞—Ç–∞.

**Response:**
```json
{
  "plan_id": "beta",
  "plan_name": "BETA",
  "status": "active",
  "started_at": "2025-12-15T00:00:00Z",
  "expires_at": "2030-01-15T00:00:00Z", 
  "days_left": 100000,
  "auto_renew": true,
  "features": [
    "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è",
    "–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏",
    "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞",
    "API –¥–æ—Å—Ç—É–ø"
  ]
}
```

---

## 10. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### GET /notifications
–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` ‚Äî –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- `unread` ‚Äî —Ç–æ–ª—å–∫–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ (true/false)
- `type` ‚Äî —Ç–∏–ø (system, achievement, chat, security)

**Response:**
```json
{
  "notifications": [
    {
      "id": 1,
      "type": "achievement",
      "title": "–ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!",
      "message": "–í—ã –ø–æ–ª—É—á–∏–ª–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ ¬´–ë–æ–ª—Ç—É–Ω¬ª",
      "icon": "üèÜ",
      "read": false,
      "created_at": "2024-12-20T14:00:00Z"
    }
  ],
  "unread_count": 3
}
```

### POST /notifications/{id}/read
–û—Ç–º–µ—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ.

### POST /notifications/read-all
–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ.

---

## –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| 200 | –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å |
| 201 | –†–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω |
| 400 | –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏) |
| 401 | –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω |
| 403 | –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω |
| 404 | –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω |
| 409 | –ö–æ–Ω—Ñ–ª–∏–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ) |
| 422 | –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| 429 | –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

---

## –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫

```json
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
    "details": {
      "field": "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–ª–µ–º"
    }
  }
}
```

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ—Ç–∞.

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------------|----------|--------|
| `{user}` | –ò–º—è –∏–ª–∏ @username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | @dmitry |
| `{target}` | –¶–µ–ª—å –¥–µ–π—Å—Ç–≤–∏—è (–¥–ª—è –∂–∞–ª–æ–±) | @spammer |
| `{duration}` | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞–∫–∞–∑–∞–Ω–∏—è | 1h, 30d |
| `{reason}` | –ü—Ä–∏—á–∏–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è | –°–ø–∞–º |
| `{warnings}` | –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π | 2 |
| `{max}` | –ú–∞–∫—Å–∏–º—É–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –¥–æ –±–∞–Ω–∞ | 3 |
| `{days}` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –±–∞–Ω–∞ | 30 |
| `{message}` | –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è –∂–∞–ª–æ–±) | "–≠—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø–∞–º–∏—Ç" |

---

## Rate Limiting

- **–û–±—â–∏–π –ª–∏–º–∏—Ç:** 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏:** 30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

–ó–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞:
```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1703001234
```

---

## WebSocket (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

**Endpoint:** `wss://api.cortes.ai/ws`

**–°–æ–±—ã—Ç–∏—è:**
- `auth:success` ‚Äî —É—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `auth:expired` ‚Äî —Ç–æ–∫–µ–Ω –∏—Å—Ç—ë–∫

```json
{
  "event": "auth:success",
  "data": {
    "access_token": "jwt_token",
    "user": { ... }
  }
}
```
